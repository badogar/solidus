$(document).ready(function() {

  if ($('input#preferences_use_s3[type="checkbox"]:checked').length > 0) {
    $('#s3_settings, #s3_headers').show();
  }

  // Toggle display of S3 settings based on value of use_s3 checkbox
  $('input#preferences_use_s3[type="checkbox"]').click(function() {
    $('#s3_settings, #s3_headers').toggle();
  });

  $('.destroy_style').live("click", function(e) {
    e.preventDefault();
    $(this).parent().remove();
  });

  $('.destroy_header').live("click", function(e) {
    e.preventDefault();
    $(this).parent().remove();
  });

  // Handle adding new styles
  var styles_hash_index = 1;
  $('.add_style').live("click", function(e) {
    e.preventDefault();
    $('#styles_list').append(generate_html_for_hash("new_attachment_styles", styles_hash_index));
  });

  // Handle adding new headers
  var headers_hash_index = 1;
  $('.add_header').live("click", function(e) {
    e.preventDefault();
    $('#headers_list').append(generate_html_for_hash("new_s3_headers", headers_hash_index));
  });

  // Generates html for new paperclip styles form fields
  generate_html_for_hash = function(hash_name, index) {
    var html = '<div class="field">';
    html += '<label for="' + hash_name + '_' + index + '_name">';
    html += '<%= I18n.t(:name) %></label><br>';
    html += '<input id="' + hash_name + '_' + index + '_name" name="' + hash_name + '[' + index + '][name]" type="text"><br>';
    html += '<label for="' + hash_name + '_' + index + '_value">';
    html += '<%= I18n.t(:value) %></label><br>';
    html += '<input id="' + hash_name + '_' + index + '_value" name="' + hash_name + '[' + index + '][value]" type="text">';
    html += '<a href="#" title="<%= I18n.t(:destroy) %>" class="destroy_style with-tip"><i class="icon-trash"></i></a>';
    html += '</div>';

    index += 1;
    return html;
  };



});
